<section id="skill" class="card text-center py-5 bg-light" data-aos="fade-up">
    <div class="container">
        <h2 class="section-heading title">My Skills</h2>
        <p class="section-paragraph">Here are some of the skills I have acquired over the years.</p>

        <% if (skills.length > 0) { %>
            <% 
                // Group skills by category name
                const groupedSkills = {};
                skills.forEach(skill => {
                    const categoryName = skill.category && skill.category.name ? skill.category.name : skill.category || 'Uncategorized';  // Default to 'Uncategorized' if category is missing
                    if (!groupedSkills[categoryName]) {
                        groupedSkills[categoryName] = [];
                    }
                    groupedSkills[categoryName].push(skill);
                });
            %>

            <div class="row">
                <% Object.keys(groupedSkills).forEach(categoryName => { %>
                    <div class="col-md-4">
                        <div class="card shadow">
                            <div class="card-body">
                                <h5 class="card-title"><%= categoryName %></h5>
                                <table class="table">
                                    <thead>
                                        <tr>
                                            <th>Logo</th>
                                            <th>Name</th>
                                            <th>Level</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <% groupedSkills[categoryName].forEach(skill => { %>
                                            <tr>
                                                <td>
                                                    <% if (skill.image) { %>
                                                        <img src="<%= skill.image %>" alt="<%= skill.skill %>" class="skill-img">
                                                    <% } %>
                                                </td>
                                                <td>
                                                    <p><%= skill.skill %></p>
                                                </td>
                                                <td>
                                                    <p><%= skill.level %></p>
                                                </td>
                                            </tr>
                                        <% }); %>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                <% }); %>
            </div>
        <% } else { %>
            <p>No skills available.</p>
        <% } %>
    </div>
</section>
